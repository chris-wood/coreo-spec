<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Content-Locked Encryption and Authentication of Nameless Objects</title>

  
<style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc ul {
  margin: 0;
}
/* xml2rfc nests ul directly inside ul which messes with the style badly */
ul.toc, ul.toc>ul, ul.toc ul>ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}
address {
  font-style: normal;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
/*]]>*/</style>


  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Conventions and Terminology"/>
<link href="#rfc.section.2" rel="Chapter" title="2 CLEAN Crypto"/>
<link href="#rfc.section.3" rel="Chapter" title="3 CLEAN End Host Support"/>
<link href="#rfc.section.4" rel="Chapter" title="4 FLIC Support"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Use Cases"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations"/>
<link href="#rfc.references" rel="Chapter" title="7 Normative References"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.2 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Wood, C." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-wood-icnrg-clean-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-3-13" />
  <meta name="dct.abstract" content="This document specifies CCNx CLEAN &#8211; content-locked encryption and authentication of nameless objects &#8211; as a way of enabling encrypted and naturally de-duplicated content in CCN. CLEAN allows producers to encrypt large collections of static data and use the FLIC Manifest to convey the necessary decryption information to consumers. As a result, CLEAN encrypts nameless content objects without any application input." />
  <meta name="description" content="This document specifies CCNx CLEAN &#8211; content-locked encryption and authentication of nameless objects &#8211; as a way of enabling encrypted and naturally de-duplicated content in CCN. CLEAN allows producers to encrypt large collections of static data and use the FLIC Manifest to convey the necessary decryption information to consumers. As a result, CLEAN encrypts nameless content objects without any application input." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">icnrg</td>
  <td class="right">C. Wood</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">University of California Irvine</td>
</tr>
<tr>
  <td class="left">Intended status: Experimental</td>
  <td class="right">March 13, 2017</td>
</tr>
<tr>
  <td class="left">Expires: September 14, 2017</td>
  <td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Content-Locked Encryption and Authentication of Nameless Objects<br />
  <span class="filename">draft-wood-icnrg-clean-latest</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document specifies CCNx CLEAN &#8211; content-locked encryption and authentication of nameless objects &#8211; as a way of enabling encrypted and naturally de-duplicated content in CCN. CLEAN allows producers to encrypt large collections of static data and use the FLIC Manifest to convey the necessary decryption information to consumers. As a result, CLEAN encrypts nameless content objects without any application input.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 14, 2017.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Conventions and Terminology</a></li>
</ul><li>2.   <a href="#rfc.section.2">CLEAN Crypto</a></li>
<li>3.   <a href="#rfc.section.3">CLEAN End Host Support</a></li>
<li>4.   <a href="#rfc.section.4">FLIC Support</a></li>
<li>5.   <a href="#rfc.section.5">Use Cases</a></li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a></li>
<li>7.   <a href="#rfc.references">Normative References</a></li>
<li><a href="#rfc.authors">Author's Address</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a></h1>
<p id="rfc.section.1.p.1">In CCN, nameless objects are content objects which do not carry a Name TLV field <a href="#CCNxSemantics">[CCNxSemantics]</a>.  Matching an interest to a nameless content object therefore requires knowledge of the latter&#8217;s ContentObjectHash (or ContentId). A ContentId is the cryptographic hash of a Content Object message. A router may only forward a nameless content object if its cryptographic hash digest matches that which is specified in the ContentObjectHashRestriction of the corresponding interest.</p>
<p id="rfc.section.1.p.2">Manifests are network-level structures used to convey ContentIds to consumers so that they may request nameless content objects. These are necessary since a consumer cannot know the ContentId of a nameless content object which it has not yet retrieved.  Manifests are typically used to group segments of a single, large piece of data under a common name. For example, imagine the consumer wishes to obtain the data named /foo/bar, which has a total size well beyond the 64KiB limit imposed by the CCN packet format. To transfer /foo/bar efficiently, the producer segments the /foo/bar data into fixed size chunks and, for each chunk, creates a nameless content object. Then, the producer creates a Manifest with the name /foo/bar which contains the references to each of these constituent nameless object parts, along with their ContentIds.  To fetch /foo/bar, a consumer then (a) issues a request for the name /foo/bar, (b) receives, verifies, and parses the Manifest, and (c) subsequently issues requests for each nameless content object using the provided ContentIds. (See <a href="#CCNxSemantics">[CCNxSemantics]</a> for more details.) The <a href="#FLIC">[FLIC]</a> data structure is one type of CCN Manifest data structure used to enable this mechanism.</p>
<p id="rfc.section.1.p.3">By default, the data contained inside each nameless content object is unencrypted.  If privacy is required, the producer application must explicitly encrypt the data prior to transfer. This is not ideal since it requires application-layer input. To improve this baseline scenario, we introduce CCNx CLEAN &#8211; content-locked encryption and authentication of nameless objects. CLEAN builds on recent advances in message-locked encryption (<a href="#MLE">[MLE]</a>) to encrypt nameless objects by default without invalidating their natural de-duplication properties.</p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> <a href="#conventions-and-terminology" id="conventions-and-terminology">Conventions and Terminology</a></h1>
<p id="rfc.section.1.1.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in RFC 2119 <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.1.1.p.2">The following terms are used:</p>
<p id="rfc.section.1.1.p.3">Nameless object: A CCN content object packet which contain a Name TLV field.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#clean-crypto" id="clean-crypto">CLEAN Crypto</a></h1>
<p id="rfc.section.2.p.1">CLEAN only relies on MLE, which is a form of encryption by which the encryption key for a message is derived from the message itself. For example, in MLE, a message M may be encrypted by a key K = H(M), where H is a suitable cryptographic hash function for use in MLE constructions. The encryption of M is thus computed as M&#8217; = Enc(H(M), M), where Enc is a symmetric-key encryption algorithm suitable for MLE.  This procedure is deterministic; two identical messages will be encrypted to identical ciphertext values. As a result, MLE supports natural de-duplication of data based on ciphertext equality.</p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#clean-end-host-support" id="clean-end-host-support">CLEAN End Host Support</a></h1>
<p id="rfc.section.3.p.1">Let D be a piece of data for which a producer P would normally create a Manifest with name N, i.e., M(N). Let C_1,&#8230;,C_n be the n nameless content object <em>payloads</em> created from D. The CLEAN construction works as follows:</p>
<p/>

<ol>
  <li>P computes k = KDF(H(D)), where KDF is a suitable key derivation function, such as HKDF <a href="#RFC5869">[RFC5869]</a>.</li>
  <li>For each C_i in C_1,&#8230;,C_n, P derives k_i = KDF(k + i) uses it to compute C_i&#8217; = Enc(k, C_i), where &#8216;+&#8217; is concatenation.</li>
  <li>From C_1&#8217;,&#8230;,C_n&#8217;, P creates the manifest M(N) as per the <a href="#FLIC">[FLIC]</a> specification.</li>
  <li>P inserts H(D) into the root node of M(N). (This is described in the following section.)</li>
</ol>
<p id="rfc.section.3.p.3">When complete, P publishes the manifest tree M(N) and its constituent nameless object pieces.</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#flic-support" id="flic-support">FLIC Support</a></h1>
<p id="rfc.section.4.p.1">The <a href="#FLIC">[FLIC]</a> format already includes the metadata value OverallDataDigest. For a given FLIC node F_i, this value corresponds to H(D_i), where D_i is the array of application data in the nameless content objects <em>contained in</em> F_i. If F is the root of M(N), then H(D) is the hash of complete set of application data in the manifest.  Therefore, CLEAN does not require any changes in the FLIC format.</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#use-cases" id="use-cases">Use Cases</a></h1>
<p id="rfc.section.5.p.1">Since the data digest (i.e., H(D)) is contained in the root manifest, the privacy of nameless content objects reduces to that of the root manifest. This has the following benefits:</p>
<p/>

<ol>
  <li>If access control to D is needed, P need only apply the necessary access control scheme to the root manifest so that H(D) is not leaked. This permits the encrypted nameless object leaves to be de-duplicated naturally in the network.</li>
  <li>If D is public data that a consumer Cr wishes to retrieve privately, the root manifest can be requested over a secure, ephemeral session between Cr and P. One way to establish such a channel is with <a href="#CCNxKE">[CCNxKE]</a>. Of course, if D is public, then any malicious consumer Adv may follow this approach to obtain D and decrypt nameless objects, or learn what data was requested by other consumers. However, Adv is forced to guess which name N was requested to be successful in either attack.</li>
</ol>
<p id="rfc.section.5.p.3">In both cases, the nameless content objects that carry segments of D remain protected without applying any type of encryption-based access control to them individually.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a></h1>
<p id="rfc.section.6.p.1">The CLEAN security model depends on the root manifest being protected either at rest or, optionally, in transit. If the root is protected at rest via some access control mechanism, then CLEAN remains secure in the MLE model. MLE security also holds if the root is encrypted only in transit over a secure session.</p>
<h1 id="rfc.references"><a href="#rfc.references">7.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="CCNxKE">[CCNxKE]</b>
      </td>
      <td class="top"><a title="PARC, Inc.">Marc Mosko, .</a>, <a title="PARC, Inc.">Ersin Uzun, .</a> and <a title="University of California, Irvine">Christopher. Wood</a>, "<a href="https://datatracker.ietf.org/doc/draft-wood-icnrg-ccnxkeyexchange/">CCNx Key Exchange Protocol Version 1.0</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="CCNxSemantics">[CCNxSemantics]</b>
      </td>
      <td class="top"><a title="PARC, Inc.">Mosko, M.</a>, <a title="LinkedIn">Solis, I.</a> and <a title="University of California, Irvine">C. Wood</a>, "<a href="https://tools.ietf.org/html/draft-irtf-icnrg-ccnxsemantics-04">CCNx Semantics</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="FLIC">[FLIC]</b>
      </td>
      <td class="top"><a title="University of Basel">Christian Tschudin, .</a> and <a title="University of California Irvine">Christopher. Wood</a>, "<a href="https://datatracker.ietf.org/doc/draft-tschudin-icnrg-flic/">File-Like ICN Collection (FLIC)</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="MLE">[MLE]</b>
      </td>
      <td class="top"><a title="University of California San Diego">Mihir Bellare, .</a>, <a title="University of California San Diego">Sriram Keelveedhi, .</a> and <a title="University of Wisconsin&#x2013;Madison">. Thomas Ristenpart</a>, "<a href="https://eprint.iacr.org/2012/631.pdf">Message-locked encryption and secure deduplication</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5869">[RFC5869]</b>
      </td>
      <td class="top"><a>Krawczyk, H.</a> and <a>P. Eronen</a>, "<a href="http://tools.ietf.org/html/rfc5869">HMAC-based Extract-and-Expand Key Derivation Function (HKDF)</a>", RFC 5869, DOI 10.17487/RFC5869, May 2010.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Author's Address</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Christopher A. Wood</span> 
	  <span class="n hidden">
		<span class="family-name">Wood</span>
	  </span>
	</span>
	<span class="org vcardline">University of California Irvine</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:woodc1@uci.edu">woodc1@uci.edu</a></span>

  </address>
</div>

</body>
</html>
