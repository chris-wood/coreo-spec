<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>CCNx Messages in TLV Format</title>

  
<style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc ul {
  margin: 0;
}
/* xml2rfc nests ul directly inside ul which messes with the style badly */
ul.toc, ul.toc>ul, ul.toc ul>ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}
address {
  font-style: normal;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
/*]]>*/</style>


  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Definitions"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Type-Length-Value (TLV) Packets"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Overall packet format"/>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Fixed Headers"/>
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Interest Fixed Header"/>
<link href="#rfc.section.3.2.1.1" rel="Chapter" title="3.2.1.1 Interest HopLimit"/>
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Content Object Fixed Header"/>
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 InterestReturn Fixed Header"/>
<link href="#rfc.section.3.2.3.1" rel="Chapter" title="3.2.3.1 InterestReturn HopLimit"/>
<link href="#rfc.section.3.2.3.2" rel="Chapter" title="3.2.3.2 InterestReturn Flags"/>
<link href="#rfc.section.3.2.3.3" rel="Chapter" title="3.2.3.3 Return Code"/>
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Global Formats"/>
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Pad"/>
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 Organization Specific TLVs"/>
<link href="#rfc.section.3.3.3" rel="Chapter" title="3.3.3 Hash Format"/>
<link href="#rfc.section.3.3.4" rel="Chapter" title="3.3.4 Link"/>
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Hop-by-hop TLV headers"/>
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 Interest Lifetime"/>
<link href="#rfc.section.3.4.2" rel="Chapter" title="3.4.2 Recommended Cache Time"/>
<link href="#rfc.section.3.4.3" rel="Chapter" title="3.4.3 Message Hash"/>
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Top-Level Types"/>
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 CCNx Message"/>
<link href="#rfc.section.3.6.1" rel="Chapter" title="3.6.1 Name"/>
<link href="#rfc.section.3.6.1.1" rel="Chapter" title="3.6.1.1 Name Segments"/>
<link href="#rfc.section.3.6.1.2" rel="Chapter" title="3.6.1.2 Interest Payload ID"/>
<link href="#rfc.section.3.6.2" rel="Chapter" title="3.6.2 Message TLVs"/>
<link href="#rfc.section.3.6.2.1" rel="Chapter" title="3.6.2.1 Interest Message TLVs"/>
<link href="#rfc.section.3.6.2.2" rel="Chapter" title="3.6.2.2 Content Object Message TLVs"/>
<link href="#rfc.section.3.6.3" rel="Chapter" title="3.6.3 Payload"/>
<link href="#rfc.section.3.6.4" rel="Chapter" title="3.6.4 Validation"/>
<link href="#rfc.section.3.6.4.1" rel="Chapter" title="3.6.4.1 Validation Algorithm"/>
<link href="#rfc.section.3.6.4.2" rel="Chapter" title="3.6.4.2 Validation Payload"/>
<link href="#rfc.section.4" rel="Chapter" title="4 IANA Considerations"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Packet Type Registry"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Interest Return Code Registry"/>
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Hop-by-Hop Type Registry"/>
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Top-Level Type Registry"/>
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Name Segment Type Registry"/>
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 Message Type Registry"/>
<link href="#rfc.section.4.7" rel="Chapter" title="4.7 Payload Type Registry"/>
<link href="#rfc.section.4.8" rel="Chapter" title="4.8 Validation Algorithm Type Registry"/>
<link href="#rfc.section.4.9" rel="Chapter" title="4.9 Validation Dependent Data Type Registry"/>
<link href="#rfc.section.4.10" rel="Chapter" title="4.10 Hash Function Type Registry"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations"/>
<link href="#rfc.references" rel="Chapter" title="6 References"/>
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="6.2 Informative References"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.2 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Mosko, M., Solis, I., and C. Wood" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-irtf-icnrg-ccnxmessages-04" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-3-13" />
  <meta name="dct.abstract" content="This document specifies version &quot;1&quot; of CCNx message TLV packet format, including the TLV types used by each message element and the encoding of each value.  The semantics of CCNx messages follow the CCNx Semantics specification." />
  <meta name="description" content="This document specifies version &quot;1&quot; of CCNx message TLV packet format, including the TLV types used by each message element and the encoding of each value.  The semantics of CCNx messages follow the CCNx Semantics specification." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">ICNRG</td>
  <td class="right">M. Mosko</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">PARC, Inc.</td>
</tr>
<tr>
  <td class="left">Intended status: Experimental</td>
  <td class="right">I. Solis</td>
</tr>
<tr>
  <td class="left">Expires: September 14, 2017</td>
  <td class="right">LinkedIn</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">C. Wood</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">University of California Irvine</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">March 13, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">CCNx Messages in TLV Format<br />
  <span class="filename">draft-irtf-icnrg-ccnxmessages-04</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document specifies version "1" of CCNx message TLV packet format, including the TLV types used by each message element and the encoding of each value.  The semantics of CCNx messages follow the CCNx Semantics specification.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 14, 2017.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a></li>
</ul><li>2.   <a href="#rfc.section.2">Definitions</a></li>
<li>3.   <a href="#rfc.section.3">Type-Length-Value (TLV) Packets</a></li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Overall packet format</a></li>
<li>3.2.   <a href="#rfc.section.3.2">Fixed Headers</a></li>
<ul><li>3.2.1.   <a href="#rfc.section.3.2.1">Interest Fixed Header</a></li>
<ul><li>3.2.1.1.   <a href="#rfc.section.3.2.1.1">Interest HopLimit</a></li>
</ul><li>3.2.2.   <a href="#rfc.section.3.2.2">Content Object Fixed Header</a></li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">InterestReturn Fixed Header</a></li>
<ul><li>3.2.3.1.   <a href="#rfc.section.3.2.3.1">InterestReturn HopLimit</a></li>
<li>3.2.3.2.   <a href="#rfc.section.3.2.3.2">InterestReturn Flags</a></li>
<li>3.2.3.3.   <a href="#rfc.section.3.2.3.3">Return Code</a></li>
</ul></ul><li>3.3.   <a href="#rfc.section.3.3">Global Formats</a></li>
<ul><li>3.3.1.   <a href="#rfc.section.3.3.1">Pad</a></li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">Organization Specific TLVs</a></li>
<li>3.3.3.   <a href="#rfc.section.3.3.3">Hash Format</a></li>
<li>3.3.4.   <a href="#rfc.section.3.3.4">Link</a></li>
</ul><li>3.4.   <a href="#rfc.section.3.4">Hop-by-hop TLV headers</a></li>
<ul><li>3.4.1.   <a href="#rfc.section.3.4.1">Interest Lifetime</a></li>
<li>3.4.2.   <a href="#rfc.section.3.4.2">Recommended Cache Time</a></li>
<li>3.4.3.   <a href="#rfc.section.3.4.3">Message Hash</a></li>
</ul><li>3.5.   <a href="#rfc.section.3.5">Top-Level Types</a></li>
<li>3.6.   <a href="#rfc.section.3.6">CCNx Message</a></li>
<ul><li>3.6.1.   <a href="#rfc.section.3.6.1">Name</a></li>
<ul><li>3.6.1.1.   <a href="#rfc.section.3.6.1.1">Name Segments</a></li>
<li>3.6.1.2.   <a href="#rfc.section.3.6.1.2">Interest Payload ID</a></li>
</ul><li>3.6.2.   <a href="#rfc.section.3.6.2">Message TLVs</a></li>
<ul><li>3.6.2.1.   <a href="#rfc.section.3.6.2.1">Interest Message TLVs</a></li>
<li>3.6.2.2.   <a href="#rfc.section.3.6.2.2">Content Object Message TLVs</a></li>
</ul><li>3.6.3.   <a href="#rfc.section.3.6.3">Payload</a></li>
<li>3.6.4.   <a href="#rfc.section.3.6.4">Validation</a></li>
<ul><li>3.6.4.1.   <a href="#rfc.section.3.6.4.1">Validation Algorithm</a></li>
<li>3.6.4.2.   <a href="#rfc.section.3.6.4.2">Validation Payload</a></li>
</ul></ul></ul><li>4.   <a href="#rfc.section.4">IANA Considerations</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Packet Type Registry</a></li>
<li>4.2.   <a href="#rfc.section.4.2">Interest Return Code Registry</a></li>
<li>4.3.   <a href="#rfc.section.4.3">Hop-by-Hop Type Registry</a></li>
<li>4.4.   <a href="#rfc.section.4.4">Top-Level Type Registry</a></li>
<li>4.5.   <a href="#rfc.section.4.5">Name Segment Type Registry</a></li>
<li>4.6.   <a href="#rfc.section.4.6">Message Type Registry</a></li>
<li>4.7.   <a href="#rfc.section.4.7">Payload Type Registry</a></li>
<li>4.8.   <a href="#rfc.section.4.8">Validation Algorithm Type Registry</a></li>
<li>4.9.   <a href="#rfc.section.4.9">Validation Dependent Data Type Registry</a></li>
<li>4.10.   <a href="#rfc.section.4.10">Hash Function Type Registry</a></li>
</ul><li>5.   <a href="#rfc.section.5">Security Considerations</a></li>
<li>6.   <a href="#rfc.references">References</a></li>
<ul><li>6.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>6.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This document specifies a Type-Length-Value (TLV) packet format and the TLV type and value encodings for CCNx messages.  A full description of the CCNx network protocol, providing an encoding-free description of CCNx messages and message elements, may be found in <a href="#CCNSemantics">[CCNSemantics]</a>. Several additional protocols specified in their own documents are in use that extend this specification.</p>
<p id="rfc.section.1.p.2">This document specifies: </p>

<ul>
  <li>The TLV packet format.</li>
  <li>The overall packet format for CCNx messages.</li>
  <li>The TLV types used by CCNx messages.</li>
  <li>The encoding of values for each type.</li>
  <li>Top level types that exist at the outermost containment.</li>
  <li>Interest TLVs that exist within Interest containment.</li>
  <li>Content Object TLVs that exist within Content Object containment.</li>
</ul>

<p> </p>
<p id="rfc.section.1.p.3">This document is supplemented by this document: </p>

<ul>
  <li>Message semantics: see <a href="#CCNSemantics">[CCNSemantics]</a> for the protocol operation regarding Interest and Content Object, including the Interest Return protocol.</li>
  <li>URI notation: see <a href="#CCNxURI">[CCNxURI]</a> for the CCNx URI notation.</li>
</ul>

<p> </p>
<p id="rfc.section.1.p.4">The type values in <a href="#IANA">Section 4</a> represent the values in common usage today.  These values may change pending IANA assignments. All type values are relative to their parent containers. It is possible for a TLV to redefine a type value defined by its parent.  For example, each level of a nested TLV structure might define a "type = 1" with a completely different meaning.</p>
<p id="rfc.section.1.p.5">Packets are represented as 32-bit wide words using ASCII art.  Due to the nested levels of TLV encoding and the presence of optional fields and variable sizes, there is no concise way to represent all possibilities.  We use the convention that ASCII art fields enclosed by vertical bars "|" represent exact bit widths.  Fields with a forward slash "/" are variable bit widths, which we typically pad out to word alignment for picture readability.</p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#definitions" id="definitions">Definitions</a></h1>
<p/>

<ul>
  <li>Name: A hierarchically structured variable length identifier. It is an ordered list of path segments, which may be variable length octet strings. In human-readable form, it is represented in URI format as ccnx:/path/part. There is no host or query string. See <a href="#CCNxURI">[CCNxURI]</a> for complete details.</li>
  <li>Interest: A message requesting a Content Object with a matching Name and other optional selectors to choose from multiple objects with the same Name. Any Content Object with a Name and optional selectors that matches the Name and optional selectors of the Interest is said to satisfy the Interest.</li>
  <li>Content Object: A data object sent in response to an Interest request. It has an (optional) Name and a content payload that are bound together via cryptographic means. </li>
</ul>

<p> </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#TLV" id="TLV">Type-Length-Value (TLV) Packets</a></h1>
<p id="rfc.section.3.p.1">We use 16-bit Type and 16-bit Length fields to encode TLV based packets. This provides 64K different possible types and value field lengths of up to 64KiB.  With 64K possible types, there should be sufficient space for basic protocol types, while also allowing ample room for experimentation, application use, and growth.</p>
<p id="rfc.section.3.p.2">Specifically, the TLV types in the range 0x1000 - 0x1FFF are reserved for experimental use.  These type values are reserved in all TLV container contexts. In the event that more space is needed, either for types or for length, a new version of the protocol would be needed. See <a href="#vendor">Section 3.3.2</a> for more information about organization specific TLVs.  </p>
<div id="rfc.table.1"/>
<div id="reserved_types"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Reserved TLV Types</caption>
  <thead>
    <tr>
      <th class="center">Abbrev</th>
      <th class="center">Name</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_ORG</td>
      <td class="center"><a href="#vendor">Vendor Specific Information</a> <cite title="NONE">[vendor]</cite></td>
      <td class="left">Information specific to a vendor implementation (see below).</td>
    </tr>
    <tr>
      <td class="center">n/a</td>
      <td class="center">Experimental</td>
      <td class="left">Experimental use.</td>
    </tr>
  </tbody>
</table>
<pre>
                     1                   2
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|              Type             |            Length             |
+---------------+---------------+---------------+---------------+
</pre>
<p id="rfc.section.3.p.3">The Length field contains the length of the Value field in octets.  It does not include the length of the Type and Length fields.  They length MAY be zero.  </p>
<p id="rfc.section.3.p.4">TLV structures are nestable, allowing the Value field of one TLV structure to contain additional TLV structures. The enclosing TLV structure is called the container of the enclosed TLV.  </p>
<p id="rfc.section.3.p.5">Type values are context-dependent.  Within a TLV container, one may re-use previous type values for new context-dependent purposes.  </p>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> <a href="#packet_format" id="packet_format">Overall packet format</a></h1>
<p id="rfc.section.3.1.p.1">Each packet includes the 8 byte fixed header described below, followed by a set of TLV fields. These fields are optional hop-by-hop headers and the Packet Payload.  </p>
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|    Version    |  PacketType   |         PacketLength          |
+---------------+---------------+---------------+---------------+
|           PacketType specific fields          | HeaderLength  |
+---------------+---------------+---------------+---------------+
/ Optional Hop-by-hop header TLVs                               /
+---------------+---------------+---------------+---------------+
/ PacketPayload TLVs                                            /
+---------------+---------------+---------------+---------------+
</pre>
<p id="rfc.section.3.1.p.2">The packet payload is a TLV encoding of the CCNx message, followed by optional Validation TLVs.</p>
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
| CCNx Message TLV                                              /
+---------------+---------------+---------------+---------------+
/ Optional CCNx ValidationAlgorithm TLV                         /
+---------------+---------------+---------------+---------------+
/ Optional CCNx ValidationPayload TLV (ValidationAlg required)  /
+---------------+---------------+---------------+---------------+
</pre>
<p id="rfc.section.3.1.p.3">This document describes the Version "1" TLV encoding.</p>
<p id="rfc.section.3.1.p.4">After discarding the fixed and hop-by-hop headers the remaining PacketPayload should be a valid protocol message. Therefore, the PacketPayload always begins with a 4 byte TLV defining the protocol message (whether it is an Interest, Content Object, or other message type) and its total length.  The embedding of a self-sufficient protocol data unit inside the fixed and hop-by-hop headers allows a network stack to discard the headers and operate only on the embedded message.</p>
<p id="rfc.section.3.1.p.5">The range of bytes protected by the Validation includes the CCNx Message and the ValidationAlgorithm.</p>
<p id="rfc.section.3.1.p.6">The ContentObjectHash begins with the CCNx Message and ends at the tail of the packet.</p>
<h1 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a> <a href="#header" id="header">Fixed Headers</a></h1>
<p id="rfc.section.3.2.p.1">CCNx messages begin with an 8 byte fixed header (non-TLV format).  The HeaderLength field represents the combined length of the Fixed and Hop-by-hop headers.  The PacketLength field represents the entire Packet length.  </p>
<p id="rfc.section.3.2.p.2">A specific PacketType may assign meaning to the "PacketType specific fields".</p>
<p id="rfc.section.3.2.p.3">The PacketPayload of a CCNx packet is the protocol message itself. The Content Object Hash is computed over the PacketPayload only, excluding the fixed and hop-by-hop headers as those might change from hop to hop.  Signed information or Similarity Hashes should not include any of the fixed or hop-by-hop headers.  The PacketPayload should be self-sufficient in the event that the fixed and hop-by-hop headers are removed.  </p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|    Version    |  PacketType   |         PacketLength          |
+---------------+---------------+---------------+---------------+
|           PacketType specific fields          | HeaderLength  |
+---------------+---------------+---------------+---------------+
</pre>
<p/>

<ul>
  <li>Version: defines the version of the packet.</li>
  <li>HeaderLength: The length of the fixed header (8 bytes) and hop-by-hop headers.  The minimum value MUST be "8".</li>
  <li>PacketType: describes forwarder actions to take on the packet.</li>
  <li>PacketLength: Total octets of packet including all headers (fixed header plus hop-by-hop headers) and protocol message.</li>
  <li>PacketType Specific Fields: specific PacketTypes define the use of these bits.</li>
</ul>

<p> </p>
<p id="rfc.section.3.2.p.5">The PacketType field indicates how the forwarder should process the packet.  A Request Packet (Interest) has PacketType PT_INTEREST, a Response (Content Object) has PacketType PT_CONTENT, and an InterestReturn Packet has PacketType PT_RETURN.  </p>
<p id="rfc.section.3.2.p.6">HeaderLength is the number of octets from the start of the packet (Version) to the end of the hop-by-hop headers. PacketLength is the number of octets from the start of the packet to the end of the packet.</p>
<p id="rfc.section.3.2.p.7">The PacketType specific fields are reserved bits whose use depends on the PacketType.  They are used for network-level signaling.</p>
<h1 id="rfc.section.3.2.1"><a href="#rfc.section.3.2.1">3.2.1.</a> Interest Fixed Header</h1>
<p id="rfc.section.3.2.1.p.1">If the PacketType in the Fixed Header is PT_INTEREST, it indicates that the PacketPayload should be processed as an Interest message.  For this type of packet, the Fixed Header includes a field for a HopLimit as well as Reserved and Flags fields. The Reserved field MUST be set to 0 in an Interest - this field will be set to a return code in the case of an Interest Return.  There are currently no Flags defined, so this field MUST be set to 0.  </p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|    Version    |  PT_INTEREST  |         PacketLength          |
+---------------+---------------+---------------+---------------+
|   HopLimit    |   Reserved    |     Flags     | HeaderLength  |
+---------------+---------------+---------------+---------------+
   </pre>
<h1 id="rfc.section.3.2.1.1"><a href="#rfc.section.3.2.1.1">3.2.1.1.</a> <a href="#hoplimit" id="hoplimit">Interest HopLimit</a></h1>
<p id="rfc.section.3.2.1.1.p.1">For an Interest message, the HopLimit is a counter that is decremented with each hop. It limits the distance an Interest may travel on the network.  The node originating the Interest MAY put in any value - up to the maximum of 255.  Each node that receives an Interest with a HopLimit decrements the value upon reception.  If the value is 0 after the decrement, the Interest MUST NOT be forwarded off the node.</p>
<p id="rfc.section.3.2.1.1.p.2">It is an error to receive an Interest with a 0 hop-limit from a remote node.</p>
<h1 id="rfc.section.3.2.2"><a href="#rfc.section.3.2.2">3.2.2.</a> Content Object Fixed Header</h1>
<p id="rfc.section.3.2.2.p.1">If the PacketType in the Fixed Header is PT_CONTENT, it indicates that the PacketPayload should be processed as a Content Object message.  A Content Object defines a Flags field, however there are currently no flags defined, so the Flags field must be set to 0.</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|    Version    |  PT_CONTENT   |         PacketLength          |
+---------------+---------------+---------------+---------------+
|            Reserved           |     Flags     | HeaderLength  |
+---------------+---------------+---------------+---------------+
   </pre>
<h1 id="rfc.section.3.2.3"><a href="#rfc.section.3.2.3">3.2.3.</a> InterestReturn Fixed Header</h1>
<p id="rfc.section.3.2.3.p.1">If the PacketType in the Fixed Header is PT_RETURN, it indicates that the PacketPayload should be processed as a returned Interest message.  The only difference between this InterestReturn message and the original Interest is that the PacketType is changed to PT_RETURN and a ReturnCode is is put into the Reserved octet.  All other fields are unchanged.  The purpose of this encoding is to prevent packet length changes so no additional bytes are needed to return an Interest to the previous hop.  See <a href="#CCNSemantics">[CCNSemantics]</a> for a protocol description of this packet type.</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|    Version    |   PT_RETURN   |         PacketLength          |
+---------------+---------------+---------------+---------------+
|   HopLimit    |  ReturnCode   |     Flags     | HeaderLength  |
+---------------+---------------+---------------+---------------+
   </pre>
<h1 id="rfc.section.3.2.3.1"><a href="#rfc.section.3.2.3.1">3.2.3.1.</a> <a href="#InterestReturnHopLimit" id="InterestReturnHopLimit">InterestReturn HopLimit</a></h1>
<p id="rfc.section.3.2.3.1.p.1">This is the original Interest's HopLimit, as received.  It is the value before being decremented at the current node (i.e. the received value).</p>
<h1 id="rfc.section.3.2.3.2"><a href="#rfc.section.3.2.3.2">3.2.3.2.</a> <a href="#InterestReturnFlags" id="InterestReturnFlags">InterestReturn Flags</a></h1>
<p id="rfc.section.3.2.3.2.p.1">These are the original Flags as set in the Interest.</p>
<h1 id="rfc.section.3.2.3.3"><a href="#rfc.section.3.2.3.3">3.2.3.3.</a> <a href="#ReturnCode" id="ReturnCode">Return Code</a></h1>
<p id="rfc.section.3.2.3.3.p.1">The numeric value assigned to the return types is defined below.  This value is set by the node creating the Interest Return.</p>
<p id="rfc.section.3.2.3.3.p.2">A return code of "0" MUST NOT be used, as it indicates that the returning system did not modify the Return Code field.</p>
<div id="rfc.table.2"/>
<div id="ReturnCodeTable"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Return Codes</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="left">Return Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_RETURN_NO_ROUTE</td>
      <td class="left">No Route</td>
    </tr>
    <tr>
      <td class="center">T_RETURN_LIMIT_EXCEEDED</td>
      <td class="left">Hop Limit Exceeded</td>
    </tr>
    <tr>
      <td class="center">T_RETURN_NO_RESOURCES</td>
      <td class="left">No Resources</td>
    </tr>
    <tr>
      <td class="center">T_RETURN_PATH_ERROR</td>
      <td class="left">Path Error</td>
    </tr>
    <tr>
      <td class="center">T_RETURN_PROHIBITED</td>
      <td class="left">Prohibited</td>
    </tr>
    <tr>
      <td class="center">T_RETURN_CONGESTED</td>
      <td class="left">Congested</td>
    </tr>
    <tr>
      <td class="center">T_RETURN_MTU_TOO_LARGE</td>
      <td class="left">MTU too large</td>
    </tr>
    <tr>
      <td class="center">T_RETURN_UNSUPPORTED_HASH_RESTRICTION</td>
      <td class="left">Unsupported ContentObjectHashRestriction</td>
    </tr>
    <tr>
      <td class="center">T_RETURN_MALFORMED_INTEREST</td>
      <td class="left">Malformed Interest</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3.</a> <a href="#formats" id="formats">Global Formats</a></h1>
<p id="rfc.section.3.3.p.1">This section defines global formats that may be nested within other TLVs.</p>
<h1 id="rfc.section.3.3.1"><a href="#rfc.section.3.3.1">3.3.1.</a> <a href="#pad" id="pad">Pad</a></h1>
<p id="rfc.section.3.3.1.p.1">The pad type may be used by protocols that prefer word-aligned data.  The size of the word may be defined by the protocol.  Padding 4-byte words, for example, would use a 1-byte, 2-byte, and 3-byte Length.  Padding 8-byte words would use a (0, 1, 2, 3, 5, 6, 7)-byte Length.  </p>
<p id="rfc.section.3.3.1.p.2">A pad MAY be inserted after any TLV in the CCNx Message or in the Validation Dependent Data In the remainder of this document, we will not show optional pad TLVs.</p>
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|             T_PAD             |             Length            |
+---------------+---------------+---------------+---------------+
/                 variable length pad MUST be zeros             /
+---------------+---------------+---------------+---------------+
            </pre>
<h1 id="rfc.section.3.3.2"><a href="#rfc.section.3.3.2">3.3.2.</a> <a href="#vendor" id="vendor">Organization Specific TLVs</a></h1>
<p id="rfc.section.3.3.2.p.1">Organization specific TLVs MUST use the T_ORG type. The Length field is the length of the organization specific information plus 3. The Value begins with the 3 byte organization number derived from the last three digits of the <a href="#EpriseNumbers">IANA Private Enterprise Numbers</a> <cite title="NONE">[EpriseNumbers]</cite>, followed by the organization specific information.</p>
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|             T_ORG             |     Length (3+value length)   |
+---------------+---------------+---------------+---------------+
|   PEN[0]      |    PEN[1]     |     PEN[2]    |               /
+---------------+---------------+---------------+               +
/                  Vendor Specific Value                        /
+---------------+---------------+---------------+---------------+
            </pre>
<h1 id="rfc.section.3.3.3"><a href="#rfc.section.3.3.3">3.3.3.</a> <a href="#hash_format" id="hash_format">Hash Format</a></h1>
<p id="rfc.section.3.3.3.p.1">Hash values are used in several fields throughout a packet.  This TLV encoding is commonly embedded inside those fields to specify the specific hash function used and it's value.  Note that the reserved TLV types are also reserved here for user-defined experimental functions.</p>
<p id="rfc.section.3.3.3.p.2">The LENGTH field of the hash value MUST be less than or equal to the hash function length.  If the LENGTH is less than the full length, it is taken as the left LENGTH bytes of the hash function output.  Only the specified truncations are allowed.</p>
<p id="rfc.section.3.3.3.p.3">This nested format is used because it allows binary comparison of hash values for certain fields without a router needing to understand a new hash function.  For example, the KeyIdRestriction is bit-wise compared between an Interest's KeyIdRestriction field and a ContentObject's KeyId field.  This format means the outer field values do not change with differing hash functions so a router can still identify those fields and do a binary comparison of the hash TLV without need to understand the specific hash used.  An alternative approach, such as using T_KEYID_SHA512-256, would require each router keep an up-to-date parser and supporting user-defined hash functions here would explode the parsing state-space.</p>
<p id="rfc.section.3.3.3.p.4">A CCN entity MUST support the hash type T_SHA-256. An entity MAY support the remaining hash types.</p>
<div id="rfc.table.3"/>
<div id="hash_types"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>CCNx Hash Functions</caption>
  <thead>
    <tr>
      <th class="center">Abbrev</th>
      <th class="center">Lengths (octets)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_SHA-256</td>
      <td class="center">32</td>
    </tr>
    <tr>
      <td class="center">T_SHA-512</td>
      <td class="center">64, 32</td>
    </tr>
    <tr>
      <td class="center">n/a</td>
      <td class="center">Experimental TLV types</td>
    </tr>
  </tbody>
</table>
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|             T_FOO             |              36               |
+---------------+---------------+---------------+---------------+
|           T_SHA512            |               32              |
+---------------+---------------+---------------+---------------+
/                        32-byte hash value                     /
+---------------+---------------+---------------+---------------+
            </pre>
<p class="figure">Example nesting inside type T_FOO</p>
<h1 id="rfc.section.3.3.4"><a href="#rfc.section.3.3.4">3.3.4.</a> <a href="#Link" id="Link">Link</a></h1>
<p id="rfc.section.3.3.4.p.1">A Link is the tuple: {Name, [KeyIdRestr], [ContentObjectHashRestr]}.  It is a general encoding  that is used in both the payload of a Content Object with PayloadType = "Link" and in the KeyLink field in a KeyLocator.</p>
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+-------------------------------+
/ Mandatory CCNx Name                                           /
+---------------+---------------+-------------------------------+
/ Optional KeyIdRestriction                                     /
+---------------------------------------------------------------+
/ Optional ContentObjectHashRestriction                         /
+---------------------------------------------------------------+
            </pre>
<h1 id="rfc.section.3.4"><a href="#rfc.section.3.4">3.4.</a> <a href="#per-hop" id="per-hop">Hop-by-hop TLV headers</a></h1>
<p id="rfc.section.3.4.p.1">Hop-by-hop TLV headers are unordered and meaning MUST NOT be attached to their ordering.  Three hop-by-hop headers are described in this document:</p>
<div id="rfc.table.4"/>
<div id="hbh_types"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Hop-by-hop Header Types</caption>
  <thead>
    <tr>
      <th class="center">Abbrev</th>
      <th class="center">Name</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_INTLIFE</td>
      <td class="center"><a href="#Lifetime">Interest Lifetime</a> <cite title="NONE">[Lifetime]</cite></td>
      <td class="left">The time an Interest should stay pending at an intermediate node.</td>
    </tr>
    <tr>
      <td class="center">T_CACHETIME</td>
      <td class="center"><a href="#RCT">Recommended Cache Time</a> <cite title="NONE">[RCT]</cite></td>
      <td class="left">The Recommended Cache Time for Content Objects.</td>
    </tr>
    <tr>
      <td class="center">T_MSGHASH</td>
      <td class="center"><a href="#MH">Message Hash</a> <cite title="NONE">[MH]</cite></td>
      <td class="left">The hash of the CCNx Message to end of packet using <a href="#hash_format">Section 3.3.3</a> format.</td>
    </tr>
  </tbody>
</table>
<p id="rfc.section.3.4.p.2">Additional hop-by-hop headers are defined in higher level specifications such as the fragmentation specification.</p>
<h1 id="rfc.section.3.4.1"><a href="#rfc.section.3.4.1">3.4.1.</a> <a href="#Lifetime" id="Lifetime">Interest Lifetime</a></h1>
<p id="rfc.section.3.4.1.p.1">The Interest Lifetime is the time that an Interest should stay pending at an intermediate node.  It is expressed in milliseconds as an unsigned, network byte order integer.</p>
<p id="rfc.section.3.4.1.p.2">A value of 0 (encoded as 1 byte %x00) indicates the Interest does not elicit a Content Object response.  It should still be forwarded, but no reply is expected.</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|          T_INTLIFE            |             Length            |
+---------------+---------------+---------------+---------------+
/                                                               /
/                      Lifetime (length octets)                 /
/                                                               /
+---------------+---------------+---------------+---------------+
</pre>
<h1 id="rfc.section.3.4.2"><a href="#rfc.section.3.4.2">3.4.2.</a> <a href="#RCT" id="RCT">Recommended Cache Time</a></h1>
<p id="rfc.section.3.4.2.p.1">The Recommended Cache Time (RCT) is a measure of the useful lifetime of a Content Object as assigned by a content producer or upstream node.  It serves as a guideline to the Content Store cache in determining how long to keep the Content Object. It is a recommendation only and may be ignored by the cache.  This is in contrast to the ExpiryTime (described in <a href="#expiry">Section 3.6.2.2.2</a>)which takes precedence over the RCT and must be obeyed.</p>
<p id="rfc.section.3.4.2.p.2">Because the Recommended Cache Time is an optional hop-by-hop header and not a part of the signed message, a content producer may re-issue a previously signed Content Object with an updated RCT without needing to re-sign the message. There is little ill effect from an attacker changing the RCT as the RCT serves as a guideline only.</p>
<p id="rfc.section.3.4.2.p.3">The Recommended Cache Time (a millisecond timestamp) is a network byte ordered unsigned integer of the number of milliseconds since the epoch in UTC of when the payload expires. It is a 64-bit field.  </p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|         T_CACHETIME           |               8               |
+---------------+---------------+---------------+---------------+
/                                                               /
/                    Recommended Cache Time                     /
/                                                               /
+---------------+---------------+---------------+---------------+
</pre>
<h1 id="rfc.section.3.4.3"><a href="#rfc.section.3.4.3">3.4.3.</a> <a href="#MH" id="MH">Message Hash</a></h1>
<p id="rfc.section.3.4.3.p.1">Within a trusted domain, an operator may calculate the message hash at a border device and insert that value into the hop-by-hop headers of a message.  An egress device should remove the value.  This permits intermediate devices within that trusted domain to match against a ContentObjectHashRestriction without calculating it at every hop.</p>
<p id="rfc.section.3.4.3.p.2">The message hash is a cryptographic hash from the start of the CCNx Message to the end of the packet.  It is used to match against the <a href="#COH">ContentObjectHashRestriction</a> <cite title="NONE">[COH]</cite>.  The Message Hash may be of longer length than an Interest's restriction, in which case the device should use the left bytes of the Message Hash to check against the Interest's value.</p>
<p id="rfc.section.3.4.3.p.3">The Message Hash may only carry one hash type and there may only be one Message Hash header.</p>
<p id="rfc.section.3.4.3.p.4">The Message Hash header is unprotected, so this header is only of practical use within a trusted domain, such as an operator's autonomous system.</p>
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|          T_MSGHASH            |         (length + 4)          |
+---------------+---------------+---------------+---------------+
|         (hash type)           |            length             |
+---------------+---------------+---------------+---------------+
/                           hash value                          /
+---------------+---------------+---------------+---------------+
                </pre>
<p class="figure">Message Hash Header</p>
<h1 id="rfc.section.3.5"><a href="#rfc.section.3.5">3.5.</a> <a href="#top_level" id="top_level">Top-Level Types</a></h1>
<p id="rfc.section.3.5.p.1">The top-level TLV types listed below exist at the outermost level of a CCNx protocol message.</p>
<div id="rfc.table.5"/>
<div id="top_types"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>CCNx Top Level Types</caption>
  <thead>
    <tr>
      <th class="center">Abbrev</th>
      <th class="center">Name</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_INTEREST</td>
      <td class="center"><a href="#CCNMessage">Interest</a> <cite title="NONE">[CCNMessage]</cite></td>
      <td class="left">An Interest MessageType.</td>
    </tr>
    <tr>
      <td class="center">T_OBJECT</td>
      <td class="center"><a href="#CCNMessage">Content Object</a> <cite title="NONE">[CCNMessage]</cite></td>
      <td class="left">A Content Object MessageType</td>
    </tr>
    <tr>
      <td class="center">T_VALIDATION_ALG</td>
      <td class="center"><a href="#ValAlg">Validation Algorithm</a> <cite title="NONE">[ValAlg]</cite></td>
      <td class="left">The method of message verification such as Message Integrity Check (MIC), a Message Authentication Code (MAC), or a cryptographic signature.  </td>
    </tr>
    <tr>
      <td class="center">T_VALIDATION_PAYLOAD</td>
      <td class="center"><a href="#ValPayload">Validation Payload</a> <cite title="NONE">[ValPayload]</cite></td>
      <td class="left">The validation output, such as the CRC32C code or the RSA signature.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.3.6"><a href="#rfc.section.3.6">3.6.</a> <a href="#CCNMessage" id="CCNMessage">CCNx Message</a></h1>
<p id="rfc.section.3.6.p.1">This is the format for the CCNx protocol message itself. The CCNx message is the portion of the packet between the hop-by-hop headers and the Validation TLVs. The figure below is an expansion of the "CCNx Message TLV" depicted in the beginning of <a href="#TLV">Section 3</a>.  The CCNx message begins with MessageType and runs through the optional Payload.  The same general format is used for both Interest and Content Object messages which are differentiated by the MessageType field. The first enclosed TLV of a CCNx Message is always the Name TLV.  This is followed by an optional Message TLVs and an optional Payload TLV.</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|         MessageType           |         MessageLength         |
+---------------+---------------+---------------+---------------+
| Name TLV       (Type = T_NAME)                                |
+---------------+---------------+---------------+---------------+
/ Optional Message TLVs   (Various Types)                       /
+---------------+---------------+---------------+---------------+
/ Optional Payload TLV  (Type = T_PAYLOAD)                      /
+---------------+---------------+---------------+---------------+

</pre>
<div id="rfc.table.6"/>
<div id="CCNx_types"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>CCNx Message Types</caption>
  <thead>
    <tr>
      <th class="center">Abbrev</th>
      <th class="center">Name</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_NAME</td>
      <td class="center"><a href="#names">Name</a> <cite title="NONE">[names]</cite></td>
      <td class="left">The CCNx Name requested in an Interest or published in a Content Object.</td>
    </tr>
    <tr>
      <td class="center">T_PAYLOAD</td>
      <td class="center"><a href="#content">Payload</a> <cite title="NONE">[content]</cite></td>
      <td class="left">The message payload.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.3.6.1"><a href="#rfc.section.3.6.1">3.6.1.</a> <a href="#names" id="names">Name</a></h1>
<p id="rfc.section.3.6.1.p.1">A Name is a TLV encoded sequence of segments. The table below lists the type values appropriate for these Name segments. A Name MUST NOT include PAD TLVs.</p>
<p id="rfc.section.3.6.1.p.2">As described in <a href="#CCNSemantics">CCNx Semantics</a> <cite title="NONE">[CCNSemantics]</cite>, using the <a href="#CCNxURI">CCNx URI</a> <cite title="NONE">[CCNxURI]</cite> notation, a T_NAME with 0 length corresponds to ccnx:/ (the default route) and is distinct from a name with one zero length segment, such as ccnx:/NAME=.  In the TLV encoding, ccnx:/ corresponds to T_NAME with 0 length, while ccnx:/NAME= corresponds to T_NAME with 4 length and T_NAMESEGMENT with 0 length.</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|            T_NAME             |            Length             |
+---------------+---------------+---------------+---------------+
/ Name segment TLVs                                             /
+---------------+---------------+---------------+---------------+
</pre>
<div id="rfc.table.7"/>
<div id="name_types"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>CCNx Name Types</caption>
  <thead>
    <tr>
      <th class="center">Symbolic Name</th>
      <th class="center">Name</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_NAMESEGMENT</td>
      <td class="center"><a href="#name_segment">Name segment</a> <cite title="NONE">[name_segment]</cite></td>
      <td class="left">A generic name Segment.</td>
    </tr>
    <tr>
      <td class="center">T_IPID</td>
      <td class="center"><a href="#name_ipid">Interest Payload ID</a> <cite title="NONE">[name_ipid]</cite></td>
      <td class="left">An identifier that represents the Interest Payload field. As an example, the Payload ID might be a hash of the Interest Payload.  This provides a way to differentiate between Interests based on their payloads without having to parse all the bytes of the payload itself; instead using only this Payload ID Name segment.</td>
    </tr>
    <tr>
      <td class="center">T_APP:00 - T_APP:4096</td>
      <td class="center"><a href="#name_segment">Application Components</a> <cite title="NONE">[name_segment]</cite></td>
      <td class="left">Application-specific payload in a name segment.  An application may apply its own semantics to the 4096 reserved types.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.3.6.1.1"><a href="#rfc.section.3.6.1.1">3.6.1.1.</a> <a href="#name_segment" id="name_segment">Name Segments</a></h1>
<p id="rfc.section.3.6.1.1.p.1">4096 special application payload name segments are allocated.  These have application semantics applied to them.  A good convention is to put the application's identity in the name prior to using these name segments.</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|            (T_NAME)           |           %x14 (20)           |
+---------------+---------------+---------------+---------------+
|        (T_NAME_SEGMENT)       |           %x03 (3)            |
+---------------+---------------+---------------+---------------+
|       f                o               o      |(T_NAME_SEGMENT)
+---------------+---------------+---------------+---------------+
|               |            %x03 (3)           |       b       |
+---------------+---------------+---------------+---------------+
|      a                r       |           (T_NAME_SEGMENT)    |
+---------------+---------------+---------------+---------------+
|           %x02 (2)            |       h       |       i       |
+---------------+---------------+---------------+---------------+
</pre>
<p id="rfc.section.3.6.1.1.p.2">For example, a name like "ccnx:/foo/bar/hi" would be encoded as: </p>
<h1 id="rfc.section.3.6.1.2"><a href="#rfc.section.3.6.1.2">3.6.1.2.</a> <a href="#name_ipid" id="name_ipid">Interest Payload ID</a></h1>
<p id="rfc.section.3.6.1.2.p.1">The InterestPayloadID is a name segment created by the origin of an Interest to represent the Interest Payload.  This allows the proper multiplexing of Interests based on their name if they have different payloads. A common representation is to use a hash of the Interest Payload as the InterestPayloadID.</p>
<p id="rfc.section.3.6.1.2.p.2">As part of the TLV 'value', the InterestPayloadID contains a one identifier of method used to create the InterestPayloadID followed by a variable length octet string.   An implementation is not required to implement any of the methods to receive an Interest; the InterestPayloadID may be treated only as an opaque octet string for purposes of multiplexing Interests with different payloads.  Only a device creating an InterestPayloadID name segment or a device verifying such a segment need to implement the algorithms.</p>
<p id="rfc.section.3.6.1.2.p.3">It uses the <a href="#hash_format">Section 3.3.3</a> encoding of hash values.</p>
<p id="rfc.section.3.6.1.2.p.4">In normal operations, we recommend displaying the InterestPayloadID as an opaque octet string in a CCNx URI, as this is the common denominator for implementation parsing.</p>
<p id="rfc.section.3.6.1.2.p.5">The InterestPayloadID, even if it is a hash, should not convey any security context.  If a system requires confirmation that a specific entity created the InterestPayload, it should use a cryptographic signature on the Interest via the ValidationAlgorithm and ValidationPayload or use its own methods inside the Interest Payload.</p>
<h1 id="rfc.section.3.6.2"><a href="#rfc.section.3.6.2">3.6.2.</a> <a href="#metadata" id="metadata">Message TLVs</a></h1>
<p id="rfc.section.3.6.2.p.1">Each message type (Interest or Content Object) is associated with a set of optional Message TLVs.  Additional specification documents may extend the types associated with each.</p>
<h1 id="rfc.section.3.6.2.1"><a href="#rfc.section.3.6.2.1">3.6.2.1.</a> <a href="#IntMeta" id="IntMeta">Interest Message TLVs</a></h1>
<p id="rfc.section.3.6.2.1.p.1">There are two Message TLVs currently associated with an Interest message: the KeyIdRestriction selector and the ContentObjectHashRestr selector are used to narrow the universe of acceptable Content Objects that would satisfy the Interest.</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|         MessageType           |         MessageLength         |
+---------------+---------------+---------------+---------------+
| Name TLV                                                      |
+---------------+---------------+---------------+---------------+
/ Optional KeyIdRestriction TLV                                 /
+---------------------------------------------------------------+
/ Optional ContentObjectHashRestriction TLV                     /
+---------------------------------------------------------------+
</pre>
<div id="rfc.table.8"/>
<div id="InterestMD_types"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>CCNx Interest Message TLV Types</caption>
  <thead>
    <tr>
      <th class="center">Abbrev</th>
      <th class="center">Name</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_KEYIDRESTR</td>
      <td class="center"><a href="#KeyIdRes">KeyIdRestriction</a> <cite title="NONE">[KeyIdRes]</cite></td>
      <td class="left">A <a href="#hash_format">Section 3.3.3</a> representation of the KeyId</td>
    </tr>
    <tr>
      <td class="center">T_OBJHASHRESTR</td>
      <td class="center"><a href="#COH">ContentObjectHashRestriction</a> <cite title="NONE">[COH]</cite></td>
      <td class="left">A <a href="#hash_format">Section 3.3.3</a> representation of the hash of the specific Content Object that would satisfy the Interest.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.3.6.2.1.1"><a href="#rfc.section.3.6.2.1.1">3.6.2.1.1.</a> <a href="#KeyIdRes" id="KeyIdRes">KeyIdRestriction</a></h1>
<p id="rfc.section.3.6.2.1.1.p.1">An Interest MAY include a KeyIdRestriction selector.  This ensures that only Content Objects with matching KeyIds will satisfy the Interest. See <a href="#KeyId">Section 3.6.4.1.4.1</a> for the format of a KeyId.</p>
<h1 id="rfc.section.3.6.2.1.2"><a href="#rfc.section.3.6.2.1.2">3.6.2.1.2.</a> <a href="#COH" id="COH">ContentObjectHashRestriction</a></h1>
<p id="rfc.section.3.6.2.1.2.p.1">An Interest MAY contain a ContentObjectHashRestriction selector. This is the hash of the Content Object - the self-certifying name restriction that must be verified in the network, if an Interest carried this restriction.  It is calculated from the beginning of the CCNx Message to the end of the packet.  The LENGTH MUST be from one of the allowed values for that hash (see <a href="#hash_format">Section 3.3.3</a>).</p>
<p id="rfc.section.3.6.2.1.2.p.2">The ContentObjectHashRestriction SHOULD be of type T_SHA-256 and of length 32 bytes.</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|        T_OBJHASHRESTR         |            LENGTH+4           |
+---------------+---------------+---------------+---------------+
|          &lt;hash type&gt;          |             LENGTH            |
+---------------+---------------+---------------+---------------+
/                     LENGTH octets of hash                     /
+---------------+---------------+---------------+---------------+
</pre>
<h1 id="rfc.section.3.6.2.2"><a href="#rfc.section.3.6.2.2">3.6.2.2.</a> <a href="#COmetadata" id="COmetadata">Content Object Message TLVs</a></h1>
<p id="rfc.section.3.6.2.2.p.1">The following message TLVs are currently defined for Content Objects: PayloadType (optional) and ExpiryTime (optional).  </p>
<pre>
                      1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|         MessageType           |         MessageLength         |
+---------------+---------------+---------------+---------------+
| Name TLV                                                      |
+---------------+---------------+---------------+---------------+
/ Optional PayloadType TLV                                      /
+---------------------------------------------------------------+
/ Optional ExpiryTime TLV                                       /
+---------------------------------------------------------------+

</pre>
<div id="rfc.table.9"/>
<div id="objectMD_types"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>CCNx Content Object Message TLV Types</caption>
  <thead>
    <tr>
      <th class="center">Abbrev</th>
      <th class="center">Name</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_PAYLDTYPE</td>
      <td class="center"><a href="#payload_type">PayloadType</a> <cite title="NONE">[payload_type]</cite></td>
      <td class="left">Indicates the type of Payload contents.</td>
    </tr>
    <tr>
      <td class="center">T_EXPIRY</td>
      <td class="center"><a href="#expiry">ExpiryTime</a> <cite title="NONE">[expiry]</cite></td>
      <td class="left">The time at which the Payload expires, as expressed in the number of milliseconds since the epoch in UTC.  If missing, Content Object may be used as long as desired.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.3.6.2.2.1"><a href="#rfc.section.3.6.2.2.1">3.6.2.2.1.</a> <a href="#payload_type" id="payload_type">PayloadType</a></h1>
<p id="rfc.section.3.6.2.2.1.p.1">The PayloadType is a network byte order integer representing the general type of the Payload TLV.  <a href="#Link">Link</a> <cite title="NONE">[Link]</cite>. If this field is missing, a "Data" type is assumed.  </p>

<ul>
  <li>T_PAYLOADTYPE_DATA: Data (possibly encrypted)</li>
  <li>T_PAYLOADTYPE_KEY: Key</li>
  <li>T_PAYLOADTYPE_LINK: Link</li>
</ul>

<p> The Data type indicate that the Payload of the ContentObject is opaque application bytes. The Key type indicates that the Payload is a DER encoded public key. The Link type indicates that the Payload is one or more </p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|            T_PAYLDTYPE        |            Length             |
+---------------+---------------+---------------+---------------+
|  PayloadType  /
+---------------+
</pre>
<h1 id="rfc.section.3.6.2.2.2"><a href="#rfc.section.3.6.2.2.2">3.6.2.2.2.</a> <a href="#expiry" id="expiry">ExpiryTime</a></h1>
<p id="rfc.section.3.6.2.2.2.p.1">The ExpiryTime is the time at which the Payload expires, as expressed by a timestamp containing the number of milliseconds since the epoch in UTC.  It is a network byte order unsigned integer in a 64-bit field. A cache or end system should not respond with a Content Object past its ExpiryTime.  Routers forwarding a Content Object do not need to check the ExpiryTime.  If the ExpiryTime field is missing, the Content Object has no expressed expiration and a cache or end system may use the Content Object for as long as desired.  </p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|           T_EXPIRY            |               8               |
+---------------+---------------+---------------+---------------+
/                          ExpiryTime                           /
/                                                               /
+---------------+---------------+---------------+---------------+
</pre>
<h1 id="rfc.section.3.6.3"><a href="#rfc.section.3.6.3">3.6.3.</a> <a href="#content" id="content">Payload</a></h1>
<p id="rfc.section.3.6.3.p.1">The Payload TLV contains the content of the packet.  It MAY be of zero length.  If a packet does not have any payload, this field MAY be omitted, rather than carrying a zero length.  </p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|           T_PAYLOAD           |            Length             |
+---------------+---------------+---------------+---------------+
/                        Payload Contents                       /
+---------------+---------------+---------------+---------------+
</pre>
<h1 id="rfc.section.3.6.4"><a href="#rfc.section.3.6.4">3.6.4.</a> <a href="#Validation" id="Validation">Validation</a></h1>
<p id="rfc.section.3.6.4.p.1">Both Interests and Content Objects have the option to include information about how to validate the CCNx message.  This information is contained in two TLVs: the ValidationAlgorithm TLV and the ValidationPayload TLV.  The ValidationAlgorithm TLV specifies the mechanism to be used to verify the CCNx message. Examples include verification with a Message Integrity Check (MIC), a Message Authentication Code (MAC), or a cryptographic signature.  The ValidationPayload TLV contains the validation output, such as the CRC32C code or the RSA signature.  </p>
<p id="rfc.section.3.6.4.p.2">An Interest would most likely only use a MIC type of validation - a crc, checksum, or digest.</p>
<h1 id="rfc.section.3.6.4.1"><a href="#rfc.section.3.6.4.1">3.6.4.1.</a> <a href="#ValAlg" id="ValAlg">Validation Algorithm</a></h1>
<p id="rfc.section.3.6.4.1.p.1">The ValidationAlgorithm is a set of nested TLVs containing all of the information needed to verify the message.  The outermost container has type = T_VALIDATION_ALG.  The first nested TLV defines the specific type of validation to be performed on the message. The type is identified with the "ValidationType" as shown in the figure below and elaborated in the table below.  Nested within that container are the TLVs for any ValidationType dependent data, for example a Key Id, Key Locator etc.</p>
<p id="rfc.section.3.6.4.1.p.2">Complete examples of several types may be found in <a href="#valexamples">Section 3.6.4.1.5</a> </p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|       T_VALIDATION_ALG        |      ValidationAlgLength      |
+---------------+---------------+---------------+---------------+
|        ValidationType         |            Length             |
+---------------+---------------+---------------+---------------+
/ ValidationType dependent data                                 /
+---------------+---------------+---------------+---------------+
</pre>
<div id="rfc.table.10"/>
<div id="validator_types"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>CCNx Validation Types</caption>
  <thead>
    <tr>
      <th class="center">Abbrev</th>
      <th class="center">Name</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_CRC32C</td>
      <td class="center"><a href="#MIC">CRC32C</a> <cite title="NONE">[MIC]</cite></td>
      <td class="left">Castagnoli CRC32 (iSCSI, ext4, etc.), with normal form polynomial 0x1EDC6F41.</td>
    </tr>
    <tr>
      <td class="center">T_HMAC-SHA256</td>
      <td class="center"><a href="#MAC">HMAC-SHA256</a> <cite title="NONE">[MAC]</cite></td>
      <td class="left">HMAC (RFC 2104) using SHA256 hash.</td>
    </tr>
    <tr>
      <td class="center">T_RSA-SHA256</td>
      <td class="center"><a href="#signature_val">RSA-SHA256</a> <cite title="NONE">[signature_val]</cite></td>
      <td class="left">RSA public key signature using SHA256 digest.</td>
    </tr>
    <tr>
      <td class="center">EC-SECP-256K1</td>
      <td class="center"><a href="#signature_val">SECP-256K1</a> <cite title="NONE">[signature_val]</cite></td>
      <td class="left">Elliptic Curve signature with SECP-256K1 parameters (see <a href="#ECC">[ECC]</a>).</td>
    </tr>
    <tr>
      <td class="center">EC-SECP-384R1</td>
      <td class="center"><a href="#signature_val">SECP-384R1</a> <cite title="NONE">[signature_val]</cite></td>
      <td class="left">Elliptic Curve signature with SECP-384R1 parameters (see <a href="#ECC">[ECC]</a>).</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.3.6.4.1.1"><a href="#rfc.section.3.6.4.1.1">3.6.4.1.1.</a> <a href="#MIC" id="MIC">Message Integrity Checks</a></h1>
<p id="rfc.section.3.6.4.1.1.p.1">MICs do not require additional data in order to perform the verification. An example is CRC32C that has a "0" length value. </p>
<h1 id="rfc.section.3.6.4.1.2"><a href="#rfc.section.3.6.4.1.2">3.6.4.1.2.</a> <a href="#MAC" id="MAC">Message Authentication Checks</a></h1>
<p id="rfc.section.3.6.4.1.2.p.1">MACs are useful for communication between two trusting parties who have already shared private keys.  Examples include an RSA signature of a SHA256 digest or others.  They rely on a KeyId. Some MACs might use more than a KeyId, but those would be defined in the future. </p>
<h1 id="rfc.section.3.6.4.1.3"><a href="#rfc.section.3.6.4.1.3">3.6.4.1.3.</a> <a href="#signature_val" id="signature_val">Signature</a></h1>
<p id="rfc.section.3.6.4.1.3.p.1">Signature type Validators specify a digest mechanism and a signing algorithm to verify the message.  Examples include RSA signature og a SHA256 digest, an Elliptic Curve signature with SECP-256K1 parameters, etc. These Validators require a KeyId and a mechanism for locating the publishers public key (a KeyLocator) - optionally a PublicKey or Certificate or KeyLink.</p>
<h1 id="rfc.section.3.6.4.1.4"><a href="#rfc.section.3.6.4.1.4">3.6.4.1.4.</a> <a href="#vdd" id="vdd">Validation Dependent Data</a></h1>
<p id="rfc.section.3.6.4.1.4.p.1">Different Validation Algorithms require access to different pieces of data contained in the ValidationAlgorithm TLV. As described above, Key Ids, Key Locators, Public Keys, Certificates, Links and Key Names all play a role in different Validation Algorithms. Any number of Validation Dependent Data containers can be present in a Validation Algorithm TLV.</p>
<p id="rfc.section.3.6.4.1.4.p.2">Following is a table of CCNx ValidationType dependent data types:</p>
<div id="rfc.table.11"/>
<div id="vddtypes"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>CCNx Validation Dependent Data Types</caption>
  <thead>
    <tr>
      <th class="center">Abbrev</th>
      <th class="center">Name</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">T_KEYID</td>
      <td class="center"><a href="#KeyId">SignerKeyId</a> <cite title="NONE">[KeyId]</cite></td>
      <td class="left">An identifier of the shared secret or public key associated with a MAC or Signature.</td>
    </tr>
    <tr>
      <td class="center">T_PUBLICKEY</td>
      <td class="center"><a href="#PubKey">Public Key</a> <cite title="NONE">[PubKey]</cite></td>
      <td class="left">DER encoded public key.</td>
    </tr>
    <tr>
      <td class="center">T_CERT</td>
      <td class="center"><a href="#Cert">Certificate</a> <cite title="NONE">[Cert]</cite></td>
      <td class="left">DER encoded X509 certificate.</td>
    </tr>
    <tr>
      <td class="center">T_KEYLINK</td>
      <td class="center"><a href="#KeyLink">KeyLink</a> <cite title="NONE">[KeyLink]</cite></td>
      <td class="left">A CCNx Link object. </td>
    </tr>
    <tr>
      <td class="center">T_SIGTIME</td>
      <td class="center"><a href="#SigTime">SignatureTime</a> <cite title="NONE">[SigTime]</cite></td>
      <td class="left">A millsecond timestamp indicating the time when the signature was created. </td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.3.6.4.1.4.1"><a href="#rfc.section.3.6.4.1.4.1">3.6.4.1.4.1.</a> <a href="#KeyId" id="KeyId">KeyId</a></h1>
<p id="rfc.section.3.6.4.1.4.1.p.1">The KeyId is the publisher key identifier. It is similar to a Subject Key Identifier from X509 [RFC 5280, Section 4.2.1.2].  It should be derived from the key used to sign, such as from the SHA-256 hash of the key.  It applies to both public/private key systems and to symmetric key systems.</p>
<p id="rfc.section.3.6.4.1.4.1.p.2">The KeyId is represented using the <a href="#hash_format">Section 3.3.3</a>.  If a protocol uses a non-hash identifier, it should use one of the reserved values.</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|            T_KEYID            |            LENGTH+4           |
+---------------+---------------+---------------+---------------+
|          &lt;hash type&gt;          |             LENGTH            |
+---------------+---------------+---------------+---------------+
/                     LENGTH octets of hash                     /
+---------------+---------------+---------------+---------------+

</pre>
<h1 id="rfc.section.3.6.4.1.4.2"><a href="#rfc.section.3.6.4.1.4.2">3.6.4.1.4.2.</a> <a href="#PubKey" id="PubKey">Public Key</a></h1>
<p id="rfc.section.3.6.4.1.4.2.p.1">A Public Key is a DER encoded Subject Public Key Info block, as in an X509 certificate.</p>
<pre>
                     1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+---------------+---------------+---------------+---------------+
|          T_PUBLICKEY          |            Length             |
+---------------+---------------+---------------+---------------+
/                Public Key (DER encoded SPKI)                  /
+---------------+---------------+---------------+---------------+
</pre>
<h1 id="rfc.section.3.6.4.1.4.3"><a href="#rfc.section.3.6.4.1.4.3">3.6.4.1.4.3.</a> <a href="#Cert" id="Cert">Certificate</a></h1>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|            T_CERT             |            Length             |
+---------------+---------------+---------------+---------------+
/                 Certificate (DER encoded X509)                /
+---------------+---------------+---------------+---------------+
</pre>
<h1 id="rfc.section.3.6.4.1.4.4"><a href="#rfc.section.3.6.4.1.4.4">3.6.4.1.4.4.</a> <a href="#KeyLink" id="KeyLink">KeyLink</a></h1>
<p id="rfc.section.3.6.4.1.4.4.p.1">A KeyLink type KeyLocator is a Link.</p>
<p id="rfc.section.3.6.4.1.4.4.p.2">The KeyLink ContentObjectHashRestr, if included, is the digest of the Content Object identified by KeyLink, not the digest of the public key.  Likewise, the KeyIdRestr of the KeyLink is the KeyId of the ContentObject, not necessarily of the wrapped key.  </p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+-------------------------------+
|          T_KEYKINK            |            Length             |
+---------------+---------------+-------------------------------+
/ Link                                                          /
+---------------------------------------------------------------+
</pre>
<h1 id="rfc.section.3.6.4.1.4.5"><a href="#rfc.section.3.6.4.1.4.5">3.6.4.1.4.5.</a> <a href="#SigTime" id="SigTime">SignatureTime</a></h1>
<p id="rfc.section.3.6.4.1.4.5.p.1">The SignatureTime is a millisecond timestamp indicating the time at which a signature was created.  The signer sets this field to the current time when creating a signature. A verifier may use this time to determine whether or not the signature was created during the validity period of a key, or if it occurred in a reasonable sequence with other associated signatures. The SignatureTime is unrelated to any time associated with the actual CCNx Message, which could have been created long before the signature. The default behavior is to always include a SignatureTime when creating an authenticated message (e.g. HMAC or RSA).</p>
<p id="rfc.section.3.6.4.1.4.5.p.2">SignatureTime is a network byte ordered unsigned integer of the number of milliseconds since the epoch in UTC of when the signature was created.  It is a fixed 64-bit field.</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+-------------------------------+
|           T_SIGTIME           |               8               |
+---------------+---------------+-------------------------------+
/                         SignatureTime                         /
+---------------------------------------------------------------+
</pre>
<h1 id="rfc.section.3.6.4.1.5"><a href="#rfc.section.3.6.4.1.5">3.6.4.1.5.</a> <a href="#valexamples" id="valexamples">Validation Examples</a></h1>
<p id="rfc.section.3.6.4.1.5.p.1">As an example of a MIC type validation, the encoding for CRC32C validation would be:</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|      T_VALIDATION_ALG         |               4               |
+---------------+---------------+---------------+---------------+
|            T_CRC32C           |               0               |
+---------------+---------------+---------------+---------------+
</pre>
<p id="rfc.section.3.6.4.1.5.p.2">As an example of a MAC type validation, the encoding for an HMAC using a SHA256 hash would be:</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|       T_VALIDATION_ALG        |               40              |
+---------------+---------------+---------------+---------------+
|        T_HMAC-SHA256          |               36              |
+---------------+---------------+---------------+---------------+
|             T_KEYID           |               32              |
+---------------+---------------+---------------+---------------+
/                            KeyId                              /
/---------------+---------------+-------------------------------+
</pre>
<p id="rfc.section.3.6.4.1.5.p.3">As an example of a Signature type validation, the encoding for an RSA public key signing using a SHA256 digest and Public Key would be:</p>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|       T_VALIDATION_ALG        |      44 + Variable Length     |
+---------------+---------------+---------------+---------------+
|          T_RSA-SHA256         |      40 + Variable Length     |
+---------------+---------------+---------------+---------------+
|             T_KEYID           |               32              |
+---------------+---------------+---------------+---------------+
/                            KeyId                              /
/---------------+---------------+-------------------------------+
|          T_PUBLICKEY          |   Variable Length (~ 160)     |
+---------------+---------------+---------------+---------------+
/                Public Key (DER encoded SPKI)                  /
+---------------+---------------+---------------+---------------+
</pre>
<h1 id="rfc.section.3.6.4.2"><a href="#rfc.section.3.6.4.2">3.6.4.2.</a> <a href="#ValPayload" id="ValPayload">Validation Payload</a></h1>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|     T_VALIDATION_PAYLOAD      |  ValidationPayloadLength      |
+---------------+---------------+---------------+---------------+
/ Type-dependent data                                           /
+---------------+---------------+---------------+---------------+
</pre>
<p id="rfc.section.3.6.4.2.p.1">The ValidationPayload contains the validation output, such as the CRC32C code or the RSA signature.</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#IANA" id="IANA">IANA Considerations</a></h1>
<p id="rfc.section.4.p.1">This section details each kind of protocol value that can be registered. Each type registry can be updated by incrementally expanding the type space, i.e., by allocating and reserving new types.  As per <a href="#RFC5226">[RFC5226]</a> this section details the creation of the "CCNx Registry" and several sub-registries.  </p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Abbrev</td>
      <td class="left">CCNx</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#IANA_PacketLevel" id="IANA_PacketLevel">Packet Type Registry</a></h1>
<p id="rfc.section.4.1.p.1">The following packet types should be allocated.  A PacketType MUST be 1 byte.  New packet types are allocated via "RFC Required" action.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">Packet Type Registry</td>
    </tr>
    <tr>
      <td class="left">Parent</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Review process</td>
      <td class="left">RFC Required</td>
    </tr>
    <tr>
      <td class="left">Syntax</td>
      <td class="left">1 octet (decimal)</td>
    </tr>
  </tbody>
</table>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Packet Type Namespace</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="center">Name</th>
      <th class="center">Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">0</td>
      <td class="center">PT_INTEREST</td>
      <td class="center"><a href="#header">Fixed Header Types</a> <cite title="NONE">[header]</cite></td>
    </tr>
    <tr>
      <td class="center">1</td>
      <td class="center">PT_CONTENT</td>
      <td class="center"><a href="#header">Fixed Header Types</a> <cite title="NONE">[header]</cite></td>
    </tr>
    <tr>
      <td class="center">2</td>
      <td class="center">PT_RETURN</td>
      <td class="center"><a href="#header">Fixed Header Types</a> <cite title="NONE">[header]</cite></td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> <a href="#IANA_InterestReturnCodes" id="IANA_InterestReturnCodes">Interest Return Code Registry</a></h1>
<p id="rfc.section.4.2.p.1">The following InterestReturn code types should be allocated.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">Interest Return Code</td>
    </tr>
    <tr>
      <td class="left">Parent</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Review process</td>
      <td class="left">Expert Review, should include public standard leading to RFC.</td>
    </tr>
    <tr>
      <td class="left">Syntax</td>
      <td class="left">1 octet (decimal)</td>
    </tr>
  </tbody>
</table>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Interest Return Type Namespace</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="center">Name</th>
      <th class="center">Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">1</td>
      <td class="center">T_RETURN_NO_ROUTE</td>
      <td class="center"><a href="#ReturnCode">Fixed Header Types</a> <cite title="NONE">[ReturnCode]</cite></td>
    </tr>
    <tr>
      <td class="center">2</td>
      <td class="center">T_RETURN_LIMIT_EXCEEDED</td>
      <td class="center"><a href="#ReturnCode">Fixed Header Types</a> <cite title="NONE">[ReturnCode]</cite></td>
    </tr>
    <tr>
      <td class="center">3</td>
      <td class="center">T_RETURN_NO_RESOURCES</td>
      <td class="center"><a href="#ReturnCode">Fixed Header Types</a> <cite title="NONE">[ReturnCode]</cite></td>
    </tr>
    <tr>
      <td class="center">4</td>
      <td class="center">T_RETURN_PATH_ERROR</td>
      <td class="center"><a href="#ReturnCode">Fixed Header Types</a> <cite title="NONE">[ReturnCode]</cite></td>
    </tr>
    <tr>
      <td class="center">5</td>
      <td class="center">T_RETURN_PROHIBITED</td>
      <td class="center"><a href="#ReturnCode">Fixed Header Types</a> <cite title="NONE">[ReturnCode]</cite></td>
    </tr>
    <tr>
      <td class="center">6</td>
      <td class="center">T_RETURN_CONGESTED</td>
      <td class="center"><a href="#ReturnCode">Fixed Header Types</a> <cite title="NONE">[ReturnCode]</cite></td>
    </tr>
    <tr>
      <td class="center">7</td>
      <td class="center">T_RETURN_MTU_TOO_LARGE</td>
      <td class="center"><a href="#ReturnCode">Fixed Header Types</a> <cite title="NONE">[ReturnCode]</cite></td>
    </tr>
    <tr>
      <td class="center">8</td>
      <td class="center">T_RETURN_UNSUPPORTED_HASH_RESTRICTION</td>
      <td class="center"><a href="#ReturnCode">Fixed Header Types</a> <cite title="NONE">[ReturnCode]</cite></td>
    </tr>
    <tr>
      <td class="center">9</td>
      <td class="center">T_RETURN_MALFORMED_INTEREST</td>
      <td class="center"><a href="#ReturnCode">Fixed Header Types</a> <cite title="NONE">[ReturnCode]</cite></td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a> <a href="#IANA_HopByHop" id="IANA_HopByHop">Hop-by-Hop Type Registry</a></h1>
<p id="rfc.section.4.3.p.1">The following hop-by-hop types should be allocated.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">Hop-by-Hop Type Registry</td>
    </tr>
    <tr>
      <td class="left">Parent</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Review process</td>
      <td class="left">RFC Required</td>
    </tr>
    <tr>
      <td class="left">Syntax</td>
      <td class="left">2 octet TLV type (decimal)</td>
    </tr>
  </tbody>
</table>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Hop-by-Hop Type Namespace</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="center">Name</th>
      <th class="center">Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">1</td>
      <td class="center">T_INTLIFE</td>
      <td class="center"><a href="#per-hop">Hop-by-hop TLV headers</a> <cite title="NONE">[per-hop]</cite></td>
    </tr>
    <tr>
      <td class="center">2</td>
      <td class="center">T_CACHETIME</td>
      <td class="center"><a href="#per-hop">Hop-by-hop TLV headers</a> <cite title="NONE">[per-hop]</cite></td>
    </tr>
    <tr>
      <td class="center">3</td>
      <td class="center">T_MSGHASH</td>
      <td class="center"><a href="#per-hop">Hop-by-hop TLV headers</a> <cite title="NONE">[per-hop]</cite></td>
    </tr>
    <tr>
      <td class="center">4 - 7</td>
      <td class="center">Reserved</td>
      <td class="center"/>
    </tr>
    <tr>
      <td class="center">%x0FFE</td>
      <td class="center">T_PAD</td>
      <td class="center"><a href="#pad">Pad</a> <cite title="NONE">[pad]</cite></td>
    </tr>
    <tr>
      <td class="center">%x0FFF</td>
      <td class="center">T_ORG</td>
      <td class="center"><a href="#vendor">Organization-Specific TLVs</a> <cite title="NONE">[vendor]</cite></td>
    </tr>
    <tr>
      <td class="center">%x1000-%x1FFF</td>
      <td class="center">Reserved</td>
      <td class="center"><a href="#TLV">Experimental Use</a> <cite title="NONE">[TLV]</cite></td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.4"><a href="#rfc.section.4.4">4.4.</a> <a href="#IANA_TopLevel" id="IANA_TopLevel">Top-Level Type Registry</a></h1>
<p id="rfc.section.4.4.p.1">The following top-level types should be allocated.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">Top-Level Type Registry</td>
    </tr>
    <tr>
      <td class="left">Parent</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Review process</td>
      <td class="left">RFC Required</td>
    </tr>
    <tr>
      <td class="left">Syntax</td>
      <td class="left">2 octet TLV type (decimal)</td>
    </tr>
  </tbody>
</table>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Top-Level Type Namespace</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="center">Name</th>
      <th class="center">Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">1</td>
      <td class="center">T_INTEREST</td>
      <td class="center"><a href="#top_level">Top-Level Types</a> <cite title="NONE">[top_level]</cite></td>
    </tr>
    <tr>
      <td class="center">2</td>
      <td class="center">T_OBJECT</td>
      <td class="center"><a href="#top_level">Top-Level Types</a> <cite title="NONE">[top_level]</cite></td>
    </tr>
    <tr>
      <td class="center">3</td>
      <td class="center">T_VALIDATION_ALG</td>
      <td class="center"><a href="#top_level">Top-Level Types</a> <cite title="NONE">[top_level]</cite></td>
    </tr>
    <tr>
      <td class="center">4</td>
      <td class="center">T_VALIDATION_PAYLOAD</td>
      <td class="center"><a href="#top_level">Top-Level Types</a> <cite title="NONE">[top_level]</cite></td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.5"><a href="#rfc.section.4.5">4.5.</a> <a href="#IANA_NameSegment" id="IANA_NameSegment">Name Segment Type Registry</a></h1>
<p id="rfc.section.4.5.p.1">The following name segment types should be allocated.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">Name Segment Type Registry</td>
    </tr>
    <tr>
      <td class="left">Parent</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Review process</td>
      <td class="left">Expert Review with public specification</td>
    </tr>
    <tr>
      <td class="left">Syntax</td>
      <td class="left">2 octet TLV type (decimal)</td>
    </tr>
  </tbody>
</table>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Name Segment Type Namespace</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="center">Name</th>
      <th class="center">Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">1</td>
      <td class="center">T_NAMESEGMENT</td>
      <td class="center"><a href="#names">Name</a> <cite title="NONE">[names]</cite></td>
    </tr>
    <tr>
      <td class="center">2</td>
      <td class="center">T_IPID</td>
      <td class="center"><a href="#names">Name</a> <cite title="NONE">[names]</cite></td>
    </tr>
    <tr>
      <td class="center">16 - 19</td>
      <td class="center">Reserved</td>
      <td class="center">Used in other drafts</td>
    </tr>
    <tr>
      <td class="center">%x0FFF</td>
      <td class="center">T_ORG</td>
      <td class="center"><a href="#vendor">Organization-Specific TLVs</a> <cite title="NONE">[vendor]</cite></td>
    </tr>
    <tr>
      <td class="center">%x1000 - %x1FFF</td>
      <td class="center">T_APP:00 - T_APP:4096</td>
      <td class="center"><a href="#names">Application Components</a> <cite title="NONE">[names]</cite></td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.6"><a href="#rfc.section.4.6">4.6.</a> <a href="#IANA_MessageTypes" id="IANA_MessageTypes">Message Type Registry</a></h1>
<p id="rfc.section.4.6.p.1">The following CCNx message segment types should be allocated.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">Message Type Registry</td>
    </tr>
    <tr>
      <td class="left">Parent</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Review process</td>
      <td class="left">RFC Required</td>
    </tr>
    <tr>
      <td class="left">Syntax</td>
      <td class="left">2 octet TLV type (decimal)</td>
    </tr>
  </tbody>
</table>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>CCNx Message Type Namespace</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="center">Name</th>
      <th class="center">Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">0</td>
      <td class="center">T_NAME</td>
      <td class="center"><a href="#CCNMessage">Message Types</a> <cite title="NONE">[CCNMessage]</cite></td>
    </tr>
    <tr>
      <td class="center">1</td>
      <td class="center">T_PAYLOAD</td>
      <td class="center"><a href="#CCNMessage">Message Types</a> <cite title="NONE">[CCNMessage]</cite></td>
    </tr>
    <tr>
      <td class="center">2</td>
      <td class="center">T_KEYIDRESTR</td>
      <td class="center"><a href="#CCNMessage">Message Types</a> <cite title="NONE">[CCNMessage]</cite></td>
    </tr>
    <tr>
      <td class="center">3</td>
      <td class="center">T_OBJHASHRESTR</td>
      <td class="center"><a href="#CCNMessage">Message Types</a> <cite title="NONE">[CCNMessage]</cite></td>
    </tr>
    <tr>
      <td class="center">5</td>
      <td class="center">T_PAYLDTYPE</td>
      <td class="center"><a href="#COmetadata">Content Object Message Types</a> <cite title="NONE">[COmetadata]</cite></td>
    </tr>
    <tr>
      <td class="center">6</td>
      <td class="center">T_EXPIRY</td>
      <td class="center"><a href="#COmetadata">Content Object Message Types</a> <cite title="NONE">[COmetadata]</cite></td>
    </tr>
    <tr>
      <td class="center">7 - 12</td>
      <td class="center">Reserved</td>
      <td class="center">Used in other RFC drafts</td>
    </tr>
    <tr>
      <td class="center">%x0FFE</td>
      <td class="center">T_PAD</td>
      <td class="center"><a href="#pad">Pad</a> <cite title="NONE">[pad]</cite></td>
    </tr>
    <tr>
      <td class="center">%x0FFF</td>
      <td class="center">T_ORG</td>
      <td class="center"><a href="#vendor">Organization-Specific TLVs</a> <cite title="NONE">[vendor]</cite></td>
    </tr>
    <tr>
      <td class="center">%x1000-%x1FFF</td>
      <td class="center">Reserved</td>
      <td class="center"><a href="#TLV">Experimental Use</a> <cite title="NONE">[TLV]</cite></td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.7"><a href="#rfc.section.4.7">4.7.</a> <a href="#IANA_PayloadType" id="IANA_PayloadType">Payload Type Registry</a></h1>
<p id="rfc.section.4.7.p.1">The following payload types should be allocated.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">PayloadType Registry</td>
    </tr>
    <tr>
      <td class="left">Parent</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Review process</td>
      <td class="left">Expert Review with public specification</td>
    </tr>
    <tr>
      <td class="left">Syntax</td>
      <td class="left">Variable length unsigned integer (decimal)</td>
    </tr>
  </tbody>
</table>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Payload Type Namespace</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="center">Name</th>
      <th class="center">Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">0</td>
      <td class="center">T_PAYLOADTYPE_DATA</td>
      <td class="center"><a href="#payload_type">Payload Types</a> <cite title="NONE">[payload_type]</cite></td>
    </tr>
    <tr>
      <td class="center">1</td>
      <td class="center">T_PAYLOADTYPE_KEY</td>
      <td class="center"><a href="#payload_type">Payload Types</a> <cite title="NONE">[payload_type]</cite></td>
    </tr>
    <tr>
      <td class="center">2</td>
      <td class="center">T_PAYLOADTYPE_LINK</td>
      <td class="center"><a href="#payload_type">Payload Types</a> <cite title="NONE">[payload_type]</cite></td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.8"><a href="#rfc.section.4.8">4.8.</a> <a href="#IANA_ValidationAlgorithm" id="IANA_ValidationAlgorithm">Validation Algorithm Type Registry</a></h1>
<p id="rfc.section.4.8.p.1">The following validation algorithm types should be allocated.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">Validation Algorithm Type Registry</td>
    </tr>
    <tr>
      <td class="left">Parent</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Review process</td>
      <td class="left">Expert Review with public specification of the algorithm</td>
    </tr>
    <tr>
      <td class="left">Syntax</td>
      <td class="left">2 octet TLV type (decimal)</td>
    </tr>
  </tbody>
</table>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Validation Algorithm Type Namespace</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="center">Name</th>
      <th class="center">Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">2</td>
      <td class="center">T_CRC32C</td>
      <td class="center"><a href="#ValAlg">Validation Algorithm</a> <cite title="NONE">[ValAlg]</cite></td>
    </tr>
    <tr>
      <td class="center">4</td>
      <td class="center">T_HMAC-SHA256</td>
      <td class="center"><a href="#ValAlg">Validation Algorithm</a> <cite title="NONE">[ValAlg]</cite></td>
    </tr>
    <tr>
      <td class="center">5</td>
      <td class="center">T_RSA-SHA256</td>
      <td class="center"><a href="#ValAlg">Validation Algorithm</a> <cite title="NONE">[ValAlg]</cite></td>
    </tr>
    <tr>
      <td class="center">6</td>
      <td class="center">EC-SECP-256K1</td>
      <td class="center"><a href="#ValAlg">Validation Algorithm</a> <cite title="NONE">[ValAlg]</cite></td>
    </tr>
    <tr>
      <td class="center">7</td>
      <td class="center">EC-SECP-384R1</td>
      <td class="center"><a href="#ValAlg">Validation Algorithm</a> <cite title="NONE">[ValAlg]</cite></td>
    </tr>
    <tr>
      <td class="center">%x0FFE</td>
      <td class="center">T_PAD</td>
      <td class="center"><a href="#pad">Pad</a> <cite title="NONE">[pad]</cite></td>
    </tr>
    <tr>
      <td class="center">%x0FFF</td>
      <td class="center">T_ORG</td>
      <td class="center"><a href="#vendor">Organization-Specific TLVs</a> <cite title="NONE">[vendor]</cite></td>
    </tr>
    <tr>
      <td class="center">%x1000-%x1FFF</td>
      <td class="center">Reserved</td>
      <td class="center"><a href="#TLV">Experimental Use</a> <cite title="NONE">[TLV]</cite></td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.9"><a href="#rfc.section.4.9">4.9.</a> <a href="#IANA_ValidationDD" id="IANA_ValidationDD">Validation Dependent Data Type Registry</a></h1>
<p id="rfc.section.4.9.p.1">The following validation dependent data types should be allocated.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">Validation Dependent Data Type Registry</td>
    </tr>
    <tr>
      <td class="left">Parent</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Review process</td>
      <td class="left">RFC Required</td>
    </tr>
    <tr>
      <td class="left">Syntax</td>
      <td class="left">2 octet TLV type (decimal)</td>
    </tr>
  </tbody>
</table>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Validation Dependent Data Type Namespace</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="center">Name</th>
      <th class="center">Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">9</td>
      <td class="center">T_KEYID</td>
      <td class="center"><a href="#vdd">Validation Dependent Data</a> <cite title="NONE">[vdd]</cite></td>
    </tr>
    <tr>
      <td class="center">10</td>
      <td class="center">T_PUBLICKEYLOC</td>
      <td class="center"><a href="#vdd">Validation Dependent Data</a> <cite title="NONE">[vdd]</cite></td>
    </tr>
    <tr>
      <td class="center">11</td>
      <td class="center">T_PUBLICKEY</td>
      <td class="center"><a href="#vdd">Validation Dependent Data</a> <cite title="NONE">[vdd]</cite></td>
    </tr>
    <tr>
      <td class="center">12</td>
      <td class="center">T_CERT</td>
      <td class="center"><a href="#vdd">Validation Dependent Data</a> <cite title="NONE">[vdd]</cite></td>
    </tr>
    <tr>
      <td class="center">13</td>
      <td class="center">T_LINK</td>
      <td class="center"><a href="#vdd">Validation Dependent Data</a> <cite title="NONE">[vdd]</cite></td>
    </tr>
    <tr>
      <td class="center">14</td>
      <td class="center">T_KEYLINK</td>
      <td class="center"><a href="#vdd">Validation Dependent Data</a> <cite title="NONE">[vdd]</cite></td>
    </tr>
    <tr>
      <td class="center">15</td>
      <td class="center">T_SIGTIME</td>
      <td class="center"><a href="#vdd">Validation Dependent Data</a> <cite title="NONE">[vdd]</cite></td>
    </tr>
    <tr>
      <td class="center">%x0FFF</td>
      <td class="center">T_ORG</td>
      <td class="center"><a href="#vendor">Organization-Specific TLVs</a> <cite title="NONE">[vendor]</cite></td>
    </tr>
    <tr>
      <td class="center">%x1000-%x1FFF</td>
      <td class="center">Reserved</td>
      <td class="center"><a href="#TLV">Experimental Use</a> <cite title="NONE">[TLV]</cite></td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.10"><a href="#rfc.section.4.10">4.10.</a> <a href="#IANA_HashFunctions" id="IANA_HashFunctions">Hash Function Type Registry</a></h1>
<p id="rfc.section.4.10.p.1">The following CCNx hash function types should be allocated.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Registry Creation</caption>
  <thead>
    <tr>
      <th class="left">Property</th>
      <th class="left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Name</td>
      <td class="left">Hash Function Type Registry</td>
    </tr>
    <tr>
      <td class="left">Parent</td>
      <td class="left">CCNx Registry</td>
    </tr>
    <tr>
      <td class="left">Review process</td>
      <td class="left">Expert Review with public specification of the hash function</td>
    </tr>
    <tr>
      <td class="left">Syntax</td>
      <td class="left">2 octet TLV type (decimal)</td>
    </tr>
  </tbody>
</table>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>CCNx Hash Function Type Namespace</caption>
  <thead>
    <tr>
      <th class="center">Type</th>
      <th class="center">Name</th>
      <th class="center">Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="center">1</td>
      <td class="center">T_SHA-256</td>
      <td class="center"><a href="#hash_format">Hash Format</a> <cite title="NONE">[hash_format]</cite></td>
    </tr>
    <tr>
      <td class="center">2</td>
      <td class="center">T_SHA-512</td>
      <td class="center"><a href="#hash_format">Hash Format</a> <cite title="NONE">[hash_format]</cite></td>
    </tr>
    <tr>
      <td class="center">%x0FFF</td>
      <td class="center">T_ORG</td>
      <td class="center"><a href="#vendor">Organization-Specific TLVs</a> <cite title="NONE">[vendor]</cite></td>
    </tr>
    <tr>
      <td class="center">%x1000-%x1FFF</td>
      <td class="center">Reserved</td>
      <td class="center"><a href="#TLV">Experimental Use</a> <cite title="NONE">[TLV]</cite></td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#Security" id="Security">Security Considerations</a></h1>
<p id="rfc.section.5.p.1">The CCNx message format includes the ability to attach MICs, MACs, and Signatures to all packet types.  This does not mean that it is a good idea to use an arbitrary ValidationAlgorithm, nor to include computationally expensive algorithms in Interest packets, as that could lead to computational DoS attacks.  Application protocols should use an explicit protocol to guide their use of packet signatures.  </p>
<p id="rfc.section.5.p.2">The CCNx message format does not include explicit guidance for encryption.  This is covered by other specifications.  </p>
<p id="rfc.section.5.p.3">Because some implementations may store the entire Name at intermediate hops, application designers should use concise names and not store large fields there.  Deployments may choose to use their own guidelines for name limitations.  There is currently no recommended practices for Interest deployments.  </p>
<h1 id="rfc.references"><a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">6.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="CCN">[CCN]</b>
      </td>
      <td class="top"><a>PARC, Inc.</a>, "<a href="http://www.CCNx.org">CCNx Open Source</a>", 2007.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="CCNSemantics">[CCNSemantics]</b>
      </td>
      <td class="top"><a title="PARC, Inc.">Mosko, M.</a>, <a title="LinkedIn">Solis, I.</a> and <a title="University of California, Irvine">C. Wood</a>, "<a href="http://tools.ietf.org/html/draft-mosko-icnrg-ccnxsemantics-04">CCNx Semantics (Internet draft)</a>", 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="CCNxURI">[CCNxURI]</b>
      </td>
      <td class="top"><a title="PARC, Inc.">Mosko, M.</a> and <a title="University of California, Irvine.">C. Wood</a>, "<a href="http://tools.ietf.org/html/draft-mosko-icnrg-ccnxuri-02">The CCNx URI Scheme (Internet draft)</a>", 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="ECC">[ECC]</b>
      </td>
      <td class="top"><a>Certicom Research</a>, "<a href="http://www.secg.org/sec2-v2.pdf">SEC 2: Recommended Elliptic Curve Domain Parameters</a>", 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="EpriseNumbers">[EpriseNumbers]</b>
      </td>
      <td class="top"><a>IANA</a>, "<a href="http://www.iana.org/assignments/enterprise-numbers/enterprise-numbers">IANA Private Enterprise Numbers</a>", 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3552">[RFC3552]</b>
      </td>
      <td class="top"><a>Rescorla, E.</a> and <a>B. Korver</a>, "<a href="http://tools.ietf.org/html/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>", BCP 72, RFC 3552, DOI 10.17487/RFC3552, July 2003.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5226">[RFC5226]</b>
      </td>
      <td class="top"><a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, DOI 10.17487/RFC5226, May 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5280">[RFC5280]</b>
      </td>
      <td class="top"><a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, DOI 10.17487/RFC5280, May 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6920">[RFC6920]</b>
      </td>
      <td class="top"><a>Farrell, S.</a>, <a>Kutscher, D.</a>, <a>Dannewitz, C.</a>, <a>Ohlman, B.</a>, <a>Keranen, A.</a> and <a>P. Hallam-Baker</a>, "<a href="http://tools.ietf.org/html/rfc6920">Naming Things with Hashes</a>", RFC 6920, DOI 10.17487/RFC6920, April 2013.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Marc Mosko</span> 
	  <span class="n hidden">
		<span class="family-name">Mosko</span>
	  </span>
	</span>
	<span class="org vcardline">PARC, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Palo Alto</span>,  
		<span class="region">California</span> 
		<span class="code">94304</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +01 650-812-4405</span>

<span class="vcardline">EMail: <a href="mailto:marc.mosko@parc.com">marc.mosko@parc.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ignacio Solis</span> 
	  <span class="n hidden">
		<span class="family-name">Solis</span>
	  </span>
	</span>
	<span class="org vcardline">LinkedIn</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Mountain View</span>,  
		<span class="region">California</span> 
		<span class="code">94043</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:nsolis@linkedin.com">nsolis@linkedin.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Christopher A. Wood</span> 
	  <span class="n hidden">
		<span class="family-name">Wood</span>
	  </span>
	</span>
	<span class="org vcardline">University of California Irvine</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Irvine</span>,  
		<span class="region">California</span> 
		<span class="code">92697</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +01 315-806-5939</span>

<span class="vcardline">EMail: <a href="mailto:woodc1@uci.edu">woodc1@uci.edu</a></span>

  </address>
</div>

</body>
</html>
